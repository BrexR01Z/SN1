{% extends 'base.html' %}
{% load static %}

{% block title %}Editar Reserva - SportsNet{% endblock %}

{% block extra_css %}
  <link rel="stylesheet" href="{% static 'css/editar_reserva.css' %}">
{% endblock %}

{% block contenido %}

<div class="editar-reserva-container">
  <h1 class="titulo">Editar Reserva</h1>

  <div class="info-reserva">
    <div class="info-item">
      <span class="label">Cancha:</span>
      {% if reserva.cancha %}
        <span class="valor">{{ reserva.cancha.nombre }}</span>
      {% else %}
        <span class="valor" style="color: #9ca3af;">Cancha eliminada</span>
      {% endif %}
    </div>
    <div class="info-item">
      <span class="label">Establecimiento:</span>
      {% if reserva.cancha %}
        <span class="valor">{{ reserva.cancha.establecimiento.nombre }}</span>
      {% else %}
        <span class="valor" style="color: #9ca3af;">Establecimiento no disponible</span>
      {% endif %}
    </div>
  </div>

  {% if form.non_field_errors %}
    <div style="background: #2c1f1f; border: 2px solid #ef4444; border-radius: 0.5rem; padding: 1rem; margin-bottom: 1rem;">
      {% for error in form.non_field_errors %}
        <p style="color: #ef4444; margin: 0.5rem 0; font-weight: 600;">{{ error }}</p>
      {% endfor %}
    </div>
  {% endif %}

  <form method="POST" novalidate>
    {% csrf_token %}

    <div class="form-group">
      <label for="{{ form.fecha.id_for_label }}">{{ form.fecha.label }}</label>
      {{ form.fecha }}
      {% if form.fecha.errors %}
        <div style="background: #2c1f1f; border-left: 3px solid #ef4444; padding: 0.5rem; margin-top: 0.25rem; border-radius: 0.25rem;">
          {% for error in form.fecha.errors %}
            <span class="error" style="color: #ef4444; display: block;">{{ error }}</span>
          {% endfor %}
        </div>
      {% endif %}
    </div>

    <div class="form-group">
      <label for="{{ form.hora_inicio.id_for_label }}">{{ form.hora_inicio.label }}</label>
      {{ form.hora_inicio }}
      {% if form.hora_inicio.errors %}
        <div style="background: #2c1f1f; border-left: 3px solid #ef4444; padding: 0.5rem; margin-top: 0.25rem; border-radius: 0.25rem;">
          {% for error in form.hora_inicio.errors %}
            <span class="error" style="color: #ef4444; display: block;">{{ error }}</span>
          {% endfor %}
        </div>
      {% endif %}
    </div>

    <div class="form-group">
      <label for="{{ form.duracion_bloques.id_for_label }}">{{ form.duracion_bloques.label }}</label>
      {{ form.duracion_bloques }}
      {% if form.duracion_bloques.errors %}
        <div style="background: #2c1f1f; border-left: 3px solid #ef4444; padding: 0.5rem; margin-top: 0.25rem; border-radius: 0.25rem;">
          {% for error in form.duracion_bloques.errors %}
            <span class="error" style="color: #ef4444; display: block;"> {{ error }}</span>
          {% endfor %}
        </div>
      {% endif %}
    </div>

    <div class="form-group">
      <label for="{{ form.comentario.id_for_label }}">{{ form.comentario.label }}</label>
      {{ form.comentario }}
    </div>

    {% if es_dueno_cancha %}
      <div class="form-group">
        <label for="estado">Estado</label>
        <select name="estado" id="estado">
          <option value="PENDIENTE" {% if reserva.estado == 'PENDIENTE' %}selected{% endif %}>Pendiente</option>
          <option value="CONFIRMADA" {% if reserva.estado == 'CONFIRMADA' %}selected{% endif %}>Confirmada</option>
          <option value="EN_CURSO" {% if reserva.estado == 'EN_CURSO' %}selected{% endif %}>En Curso</option>
          <option value="TERMINADA" {% if reserva.estado == 'TERMINADA' %}selected{% endif %}>Terminada</option>
        </select>
      </div>
    {% endif %}

    <div class="botones">
      <button type="submit" class="btn btn-guardar">Guardar Cambios</button>
      <a href="{% url 'reservas:listar_reservas' %}" class="btn btn-volver">Cancelar</a>
    </div>
  </form>
</div>

{% endblock %}